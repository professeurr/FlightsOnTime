2020-11-07 23:00:56,668 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2020-11-07 23:00:56,964 INFO $: Initializing...
2020-11-07 23:00:58,072 INFO $: loading configuration...
2020-11-07 23:00:58,073 INFO $: configuration file 'config.json' is provided, let's initialize the session.
2020-11-07 23:00:58,809 INFO $: [START]
2020-11-07 23:00:58,830 INFO $: Loading weather stations file:///home/masterai/dev/master_iasd/bigdata/project/flightsontime/data/wban_airport_timezone.csv
+---------+------------+--------+
|AirportID|STATION_WBAN|TimeZone|
+---------+------------+--------+
|10685    |54831       |-21600  |
|14871    |24232       |-28800  |
|10620    |24033       |-25200  |
|14747    |24233       |-28800  |
|11252    |12834       |-18000  |
|14842    |23034       |-21600  |
|14771    |23234       |-28800  |
|11624    |12836       |-18000  |
|12884    |14836       |-18000  |
|13024    |94236       |-28800  |
|13459    |94836       |-18000  |
|13485    |14837       |-21600  |
|14716    |23237       |-28800  |
|11109    |93037       |-25200  |
|13360    |12838       |-18000  |
|13303    |12839       |-18000  |
|11308    |13839       |-21600  |
|13342    |14839       |-21600  |
|15024    |11640       |-14400  |
|13344    |14840       |-18000  |
+---------+------------+--------+
only showing top 20 rows

2020-11-07 23:01:02,561 INFO $: [TRAINING DATA PREPARATION]
2020-11-07 23:01:02,561 INFO $: Loading weather records from file:///home/masterai/dev/master_iasd/bigdata/project/flightsontime/data/weather/full/201301hourly.txt
2020-11-07 23:01:04,799 INFO $: weather initial number of records: 4239890;
+-----+--------+----+--------------------+--------------+-----------+---------------+-------------+----------+----------------+---------+
|WBAN |Date    |Time|SkyCondition        |DryBulbCelsius|WeatherType|StationPressure|WindDirection|Visibility|RelativeHumidity|WindSpeed|
+-----+--------+----+--------------------+--------------+-----------+---------------+-------------+----------+----------------+---------+
|03011|20130101|0000|OVC                 |M             |           |M              |120          | 5.00     |M               | 5       |
|03011|20130101|0015|SCT011 SCT020       |M             |-SN        |21.33          |120          | 7.00     |M               | 6       |
|03011|20130101|0035|CLR                 |M             |           |21.33          |120          |10.00     |M               | 6       |
|03011|20130101|0055|CLR                 |M             |           |21.33          |120          |10.00     |M               | 5       |
|03011|20130101|0115|CLR                 |M             |           |21.33          |000          |10.00     |M               | 0       |
|03011|20130101|0135|CLR                 |M             |           |21.33          |100          |10.00     |M               | 5       |
|03011|20130101|0155|CLR                 |M             |           |21.34          |100          |10.00     |M               | 3       |
|03011|20130101|0215|CLR                 |M             |           |21.34          |120          |10.00     |M               | 5       |
|03011|20130101|0235|CLR                 |M             |           |21.34          |110          |10.00     |M               | 5       |
|03011|20130101|0255|CLR                 |M             |           |21.36          |120          |10.00     |M               | 6       |
|03011|20130101|0315|CLR                 |M             |           |21.36          |120          |10.00     |M               | 5       |
|03011|20130101|0335|CLR                 |-16.0         |           |21.35          |110          |10.00     | 91             | 3       |
|03011|20130101|0355|CLR                 |-16.0         |           |21.35          |090          |10.00     | 87             | 3       |
|03011|20130101|0415|SCT028              |-17.0         |           |21.35          |000          |10.00     | 95             | 0       |
|03011|20130101|0435|SCT028              |-17.0         |-SN        |21.36          |130          | 7.00     | 95             | 5       |
|03011|20130101|0455|CLR                 |-16.0         |-SN        |21.36          |100          | 7.00     | 91             | 3       |
|03011|20130101|0515|SCT023 SCT028       |-16.0         |-SN        |21.36          |140          | 7.00     | 91             | 3       |
|03011|20130101|0535|SCT023 SCT033 BKN044|-15.0         |-SN        |21.36          |150          | 5.00     | 83             | 5       |
|03011|20130101|0555|SCT013 SCT024 OVC044|-16.0         |-SN        |21.36          |000          | 3.00     | 87             | 0       |
|03011|20130101|0615|SCT011 BKN044 OVC110|-16.0         |-SN        |21.37          |000          | 1.75     | 87             | 0       |
+-----+--------+----+--------------------+--------------+-----------+---------------+-------------+----------+----------------+---------+
only showing top 20 rows

2020-11-07 23:01:05,039 INFO $: getting timezones of each station and converting weather record time to utc...
2020-11-07 23:01:08,191 INFO $: weather number of records after the mapping with the stations: 299336
+-------------+--------------+-----------+---------------+-------------+----------+----------------+---------+---------+------------+
|SkyCondition |DryBulbCelsius|WeatherType|StationPressure|WindDirection|Visibility|RelativeHumidity|WindSpeed|AIRPORTID|WEATHER_TIME|
+-------------+--------------+-----------+---------------+-------------+----------+----------------+---------+---------+------------+
|SCT030 BKN059|23.0          |           |M              |130          |10.00     |M               | 3       |10732    |1357033800  |
|SCT020 SCT049|24.0          |           |M              |120          |10.00     |M               | 6       |10732    |1357037400  |
|SCT025       |26.0          |           |M              |110          |10.00     |M               | 7       |10732    |1357041000  |
|SCT020 SCT039|28.0          |           |M              |110          |10.00     |M               |15       |10732    |1357044600  |
|SCT010 SCT030|27.0          |           |M              |110          |10.00     |M               |13       |10732    |1357048200  |
|SCT030       |28.0          |           |M              |110          |10.00     |M               | 8       |10732    |1357051800  |
|SCT030 BKN059|27.0          |           |M              |080          |10.00     |M               |16       |10732    |1357055400  |
|SCT039 BKN079|28.0          |           |M              |050          |10.00     |M               |18       |10732    |1357059000  |
|SCT039 BKN079|28.0          |           |M              |070          |10.00     |M               |19       |10732    |1357062600  |
|SCT020       |28.0          |           |M              |080          |10.00     |M               |16       |10732    |1357066200  |
|SCT020       |27.0          |           |M              |090          |10.00     |M               |19       |10732    |1357069800  |
|SCT020       |26.0          |           |M              |070          |10.00     |M               |11       |10732    |1357073400  |
|SCT020       |26.0          |           |M              |080          |10.00     |M               |16       |10732    |1357077000  |
|SCT020       |25.0          |           |M              |090          |10.00     |M               |11       |10732    |1357080600  |
|SCT020       |25.0          |           |M              |100          |10.00     |M               |11       |10732    |1357084200  |
|SCT020       |23.0          |           |M              |120          |10.00     |M               | 6       |10732    |1357105800  |
|SCT020       |22.0          |           |M              |120          |10.00     |M               | 6       |10732    |1357109400  |
|SCT020       |22.0          |           |M              |120          |10.00     |M               | 6       |10732    |1357113000  |
|SCT020       |22.0          |           |M              |000          |10.00     |M               | 0       |10732    |1357116600  |
|SCT025 SCT049|22.0          |           |M              |140          |10.00     |M               | 3       |10732    |1357120200  |
+-------------+--------------+-----------+---------------+-------------+----------+----------------+---------+---------+------------+
only showing top 20 rows

2020-11-07 23:01:12,700 INFO $: transforming/cleaning weather variables...
2020-11-07 23:01:12,700 INFO $: cleaning SkyCondition...
2020-11-07 23:01:12,970 INFO $: cleaning WeatherType...
2020-11-07 23:01:12,989 INFO $: cleaning WindDirection...
2020-11-07 23:01:13,000 INFO $: cleaning Visibility...
2020-11-07 23:01:13,014 INFO $: cleaning Temperature...
2020-11-07 23:01:13,027 INFO $: cleaning numerical variables...
2020-11-07 23:01:13,072 INFO $: assembling weather conditions
2020-11-07 23:01:13,157 INFO $: fitting features (one-hot encoding + vector assembler)...
2020-11-07 23:01:22,196 INFO $: saving weather trained pipeline to a file 'file:///home/masterai/dev/master_iasd/bigdata/project/flightsontime/model/full/weather.pipeline'...
2020-11-07 23:01:24,443 INFO $: transforming features (one-hot encoding + vector assembler)...
+-------------+-----------------------+--------------------------+------------------------+
|SkyCondition |SkyConditionLowCategory|SkyConditionMediumCategory|SkyConditionHighCategory|
+-------------+-----------------------+--------------------------+------------------------+
|SCT030 BKN059|3.0                    |4.0                       |4.0                     |
|SCT020 SCT049|3.0                    |3.0                       |3.0                     |
|SCT025       |3.0                    |3.0                       |3.0                     |
|SCT020 SCT039|3.0                    |3.0                       |3.0                     |
|SCT010 SCT030|3.0                    |3.0                       |3.0                     |
|SCT030       |3.0                    |3.0                       |3.0                     |
|SCT030 BKN059|3.0                    |4.0                       |4.0                     |
|SCT039 BKN079|3.0                    |4.0                       |4.0                     |
|SCT039 BKN079|3.0                    |4.0                       |4.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT020       |3.0                    |3.0                       |3.0                     |
|SCT025 SCT049|3.0                    |3.0                       |3.0                     |
+-------------+-----------------------+--------------------------+------------------------+
only showing top 20 rows

+-------------+-------------------+----------------------+--------------------+
|SkyCondition |SkyConditionLowVect|SkyConditionMediumVect|SkyConditionHighVect|
+-------------+-------------------+----------------------+--------------------+
|SCT030 BKN059|(5,[3],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |
|SCT020 SCT049|(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT025       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020 SCT039|(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT010 SCT030|(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT030       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT030 BKN059|(5,[3],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |
|SCT039 BKN079|(5,[3],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |
|SCT039 BKN079|(5,[3],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT020       |(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
|SCT025 SCT049|(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |
+-------------+-------------------+----------------------+--------------------+
only showing top 20 rows

+-----------+-------------------+---------------+
|WeatherType|WeatherTypeCategory|WeatherTypeVect|
+-----------+-------------------+---------------+
|-RA        |1                  |(5,[1],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|RA BR      |2                  |(5,[2],[1.0])  |
|+RA BR     |2                  |(5,[2],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA BR     |2                  |(5,[2],[1.0])  |
|-RA        |1                  |(5,[1],[1.0])  |
+-----------+-------------------+---------------+
only showing top 20 rows

+-------------+---------------------+-----------------+
|WindDirection|WindDirectionCategory|WindDirectionVect|
+-------------+---------------------+-----------------+
|130          |2                    |(9,[2],[1.0])    |
|120          |2                    |(9,[2],[1.0])    |
|110          |2                    |(9,[2],[1.0])    |
|110          |2                    |(9,[2],[1.0])    |
|110          |2                    |(9,[2],[1.0])    |
|110          |2                    |(9,[2],[1.0])    |
|080          |1                    |(9,[1],[1.0])    |
|050          |1                    |(9,[1],[1.0])    |
|070          |1                    |(9,[1],[1.0])    |
|080          |1                    |(9,[1],[1.0])    |
|090          |2                    |(9,[2],[1.0])    |
|070          |1                    |(9,[1],[1.0])    |
|080          |1                    |(9,[1],[1.0])    |
|090          |2                    |(9,[2],[1.0])    |
|100          |2                    |(9,[2],[1.0])    |
|120          |2                    |(9,[2],[1.0])    |
|120          |2                    |(9,[2],[1.0])    |
|120          |2                    |(9,[2],[1.0])    |
|000          |0                    |(9,[0],[1.0])    |
|140          |3                    |(9,[3],[1.0])    |
+-------------+---------------------+-----------------+
only showing top 20 rows

+-------------------+----------------------+--------------------+--------------------+---------------+---------------+----------------+---------+----------+--------------+----------------------------------------------------------------------------------+
|SkyConditionLowVect|SkyConditionMediumVect|SkyConditionHighVect|SkyConditionHighVect|WeatherTypeVect|StationPressure|RelativeHumidity|WindSpeed|Visibility|DryBulbCelsius|WEATHER_COND                                                                      |
+-------------------+----------------------+--------------------+--------------------+---------------+---------------+----------------+---------+----------+--------------+----------------------------------------------------------------------------------+
|(5,[4],[1.0])      |(5,[],[])             |(5,[],[])           |(5,[],[])           |(5,[1],[1.0])  |29.95          |82.0            |11.0     |8.0       |23.9          |(34,[4,16,22,29,30,31,32,33],[1.0,1.0,1.0,29.95,82.0,11.0,8.0,23.9])              |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |29.96          |90.0            |14.0     |5.0       |23.3          |(34,[2,9,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,29.96,90.0,14.0,5.0,23.3])        |
|(5,[3],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |30.0           |94.0            |7.0      |3.0       |24.0          |(34,[3,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.0,94.0,7.0,3.0,24.0])          |
|(5,[2],[1.0])      |(5,[2],[1.0])         |(5,[2],[1.0])       |(5,[2],[1.0])       |(5,[1],[1.0])  |30.07          |85.0            |11.0     |10.0      |24.4          |(34,[2,7,12,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.07,85.0,11.0,10.0,24.4])|
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[1],[1.0])  |30.12          |71.0            |13.0     |10.0      |25.6          |(34,[2,9,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.12,71.0,13.0,10.0,25.6])       |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |(5,[4],[1.0])       |(5,[1],[1.0])  |30.01          |79.0            |11.0     |10.0      |23.9          |(34,[2,9,14,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.01,79.0,11.0,10.0,23.9])|
|(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |(5,[3],[1.0])       |(5,[1],[1.0])  |30.04          |76.0            |13.0     |10.0      |25.0          |(34,[3,8,13,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.04,76.0,13.0,10.0,25.0])|
|(5,[2],[1.0])      |(5,[3],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |30.0           |97.0            |15.0     |4.0       |23.0          |(34,[2,8,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.0,97.0,15.0,4.0,23.0])         |
|(5,[2],[1.0])      |(5,[],[])             |(5,[],[])           |(5,[],[])           |(5,[1],[1.0])  |30.0           |93.0            |13.0     |9.0       |22.8          |(34,[2,16,21,29,30,31,32,33],[1.0,1.0,1.0,30.0,93.0,13.0,9.0,22.8])               |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |(5,[4],[1.0])       |(5,[1],[1.0])  |29.97          |94.0            |9.0      |7.0       |23.3          |(34,[2,9,14,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,29.97,94.0,9.0,7.0,23.3])  |
|(5,[3],[1.0])      |(5,[3],[1.0])         |(5,[3],[1.0])       |(5,[3],[1.0])       |(5,[2],[1.0])  |30.06          |87.0            |20.0     |4.0       |23.3          |(34,[3,8,13,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.06,87.0,20.0,4.0,23.3]) |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |30.08          |97.0            |20.0     |1.75      |23.0          |(34,[2,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.08,97.0,20.0,1.75,23.0])       |
|(5,[4],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |(5,[4],[1.0])       |(5,[2],[1.0])  |30.09          |90.0            |13.0     |2.5       |22.8          |(34,[4,9,14,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.09,90.0,13.0,2.5,22.8]) |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |30.09          |90.0            |11.0     |3.0       |23.0          |(34,[2,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.09,90.0,11.0,3.0,23.0])        |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |30.09          |97.0            |14.0     |2.0       |23.0          |(34,[2,9,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.09,97.0,14.0,2.0,23.0])        |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[1],[1.0])  |30.09          |97.0            |13.0     |7.0       |23.0          |(34,[2,9,16,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.09,97.0,13.0,7.0,23.0])        |
|(5,[4],[1.0])      |(5,[4],[1.0])         |(5,[4],[1.0])       |(5,[4],[1.0])       |(5,[2],[1.0])  |30.09          |90.0            |13.0     |4.0       |24.4          |(34,[4,9,14,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.09,90.0,13.0,4.0,24.4]) |
|(5,[3],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |30.07          |87.0            |14.0     |5.0       |23.9          |(34,[3,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.07,87.0,14.0,5.0,23.9])        |
|(5,[3],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[1],[1.0])  |30.05          |69.0            |11.0     |10.0      |26.7          |(34,[3,9,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.05,69.0,11.0,10.0,26.7])       |
|(5,[2],[1.0])      |(5,[4],[1.0])         |(5,[],[])           |(5,[],[])           |(5,[2],[1.0])  |30.05          |90.0            |14.0     |3.0       |24.0          |(34,[2,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.05,90.0,14.0,3.0,24.0])        |
+-------------------+----------------------+--------------------+--------------------+---------------+---------------+----------------+---------+----------+--------------+----------------------------------------------------------------------------------+
only showing top 20 rows

+---------+------------+---------------------------------------------------------------------------------+
|AIRPORTID|WEATHER_TIME|WEATHER_COND                                                                     |
+---------+------------+---------------------------------------------------------------------------------+
|15027    |1357192380  |(34,[4,16,22,29,30,31,32,33],[1.0,1.0,1.0,29.95,82.0,11.0,8.0,23.9])             |
|15027    |1357199580  |(34,[2,9,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,29.96,90.0,14.0,5.0,23.3])       |
|15027    |1357231020  |(34,[3,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.0,94.0,7.0,3.0,24.0])         |
|15027    |1357533900  |(34,[2,8,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.0,97.0,15.0,4.0,23.0])        |
|15027    |1357534380  |(34,[2,16,21,29,30,31,32,33],[1.0,1.0,1.0,30.0,93.0,13.0,9.0,22.8])              |
|15027    |1357541580  |(34,[2,9,14,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,29.97,94.0,9.0,7.0,23.3]) |
|15027    |1357642380  |(34,[3,8,13,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.06,87.0,20.0,4.0,23.3])|
|15027    |1357645440  |(34,[2,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.08,97.0,20.0,1.75,23.0])      |
|15027    |1357645980  |(34,[4,9,14,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.09,90.0,13.0,2.5,22.8])|
|15027    |1357646100  |(34,[2,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.09,90.0,11.0,3.0,23.0])       |
|15027    |1357648200  |(34,[2,9,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.09,97.0,14.0,2.0,23.0])       |
|15027    |1357648560  |(34,[2,9,16,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.09,97.0,13.0,7.0,23.0])       |
|15027    |1357649580  |(34,[4,9,14,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.09,90.0,13.0,4.0,24.4])|
|15027    |1357692780  |(34,[3,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.07,87.0,14.0,5.0,23.9])       |
|15027    |1357830660  |(34,[2,9,17,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.05,90.0,14.0,3.0,24.0])       |
|15027    |1357847580  |(34,[3,9,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.02,87.0,17.0,4.0,23.3])       |
|15027    |1357847880  |(34,[3,9,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.02,90.0,11.0,1.75,23.0])      |
|15027    |1357848600  |(34,[3,9,17,22,29,30,31,32,33],[1.0,1.0,1.0,1.0,30.02,97.0,9.0,5.0,23.0])        |
|15027    |1357861860  |(34,[3,9,14,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.04,87.0,5.0,9.0,22.0]) |
|15027    |1357861980  |(34,[3,8,13,16,21,29,30,31,32,33],[1.0,1.0,1.0,1.0,1.0,30.04,90.0,5.0,9.0,21.7]) |
+---------+------------+---------------------------------------------------------------------------------+
only showing top 20 rows

2020-11-07 23:01:53,158 INFO $: [weatherDataLoad elapsed: 56 s]
2020-11-07 23:01:53,158 INFO $: Loading flights records from file:///home/masterai/dev/master_iasd/bigdata/project/flightsontime/data/flights/full/201301.csv
+----------+---------------------+-----------------+-----------------+---------------+------------+-------------+---------+--------+----------------+-------------+---------+----+
|FL_DATE   |OP_CARRIER_AIRLINE_ID|OP_CARRIER_FL_NUM|ORIGIN_AIRPORT_ID|DEST_AIRPORT_ID|CRS_DEP_TIME|ARR_DELAY_NEW|CANCELLED|DIVERTED|CRS_ELAPSED_TIME|WEATHER_DELAY|NAS_DELAY|_c12|
+----------+---------------------+-----------------+-----------------+---------------+------------+-------------+---------+--------+----------------+-------------+---------+----+
|2013-01-01|19805                |569              |14635            |11298          |0800        |0.0          |0.0      |0.0     |180.00          |null         |null     |null|
|2013-01-01|19805                |570              |11298            |11042          |1400        |0.0          |0.0      |0.0     |160.00          |null         |null     |null|
|2013-01-01|19805                |615              |13930            |14908          |1355        |0.0          |0.0      |0.0     |260.00          |null         |null     |null|
|2013-01-01|19805                |616              |11298            |11433          |1110        |0.0          |0.0      |0.0     |160.00          |null         |null     |null|
|2013-01-01|19805                |617              |11697            |11298          |1630        |0.0          |0.0      |0.0     |200.00          |null         |null     |null|
|2013-01-01|19805                |618              |14771            |13930          |1815        |0.0          |0.0      |0.0     |240.00          |null         |null     |null|
|2013-01-01|19805                |619              |11298            |10423          |2105        |50.0         |0.0      |0.0     |55.00           |0.0          |10.0     |null|
|2013-01-01|19805                |620              |11298            |13931          |1825        |10.0         |0.0      |0.0     |165.00          |null         |null     |null|
|2013-01-01|19805                |621              |11298            |14683          |1415        |21.0         |0.0      |0.0     |70.00           |0.0          |7.0      |null|
|2013-01-01|19805                |622              |11109            |11298          |0600        |0.0          |0.0      |0.0     |120.00          |null         |null     |null|
|2013-01-01|19805                |623              |11298            |14679          |0905        |22.0         |0.0      |0.0     |195.00          |0.0          |2.0      |null|
|2013-01-01|19805                |102              |12173            |11298          |1945        |0.0          |0.0      |0.0     |450.00          |null         |null     |null|
|2013-01-01|19805                |116              |12892            |11618          |0830        |0.0          |0.0      |0.0     |325.00          |null         |null     |null|
|2013-01-01|19805                |117              |12478            |12892          |1345        |4.0          |0.0      |0.0     |380.00          |null         |null     |null|
|2013-01-01|19805                |118              |12892            |12478          |0700        |0.0          |0.0      |0.0     |325.00          |null         |null     |null|
|2013-01-01|19805                |119              |11618            |12892          |1820        |26.0         |0.0      |0.0     |390.00          |0.0          |26.0     |null|
|2013-01-01|19805                |123              |11298            |12173          |1050        |7.0          |0.0      |0.0     |515.00          |null         |null     |null|
|2013-01-01|19805                |129              |13303            |12892          |1400        |0.0          |0.0      |0.0     |355.00          |null         |null     |null|
|2013-01-01|19805                |133              |12478            |12892          |1545        |0.0          |0.0      |0.0     |385.00          |null         |null     |null|
|2013-01-01|19805                |143              |10721            |12892          |1640        |0.0          |0.0      |0.0     |390.00          |null         |null     |null|
+----------+---------------------+-----------------+-----------------+---------------+------------+-------------+---------+--------+----------------+-------------+---------+----+
only showing top 20 rows

2020-11-07 23:01:53,875 INFO $: number of flights: 509519; Flights columns: List(NAS_DELAY, OP_CARRIER_AIRLINE_ID, CANCELLED, OP_CARRIER_FL_NUM, WEATHER_DELAY, DEST_AIRPORT_ID, ORIGIN_AIRPORT_ID, CRS_ELAPSED_TIME, DIVERTED, FL_DATE, CRS_DEP_TIME, ARR_DELAY_NEW)
2020-11-07 23:01:53,875 INFO $: computing flights identifier (FL_ID)...
+--------------------------------+----------+-----------------+---------------+-------------+
|FL_ID                           |FL_DATE   |ORIGIN_AIRPORT_ID|DEST_AIRPORT_ID|WEATHER_DELAY|
+--------------------------------+----------+-----------------+---------------+-------------+
|19805_569_2013-01-01_14635_11298|2013-01-01|14635            |11298          |null         |
|19805_570_2013-01-01_11298_11042|2013-01-01|11298            |11042          |null         |
|19805_615_2013-01-01_13930_14908|2013-01-01|13930            |14908          |null         |
|19805_616_2013-01-01_11298_11433|2013-01-01|11298            |11433          |null         |
|19805_617_2013-01-01_11697_11298|2013-01-01|11697            |11298          |null         |
|19805_618_2013-01-01_14771_13930|2013-01-01|14771            |13930          |null         |
|19805_619_2013-01-01_11298_10423|2013-01-01|11298            |10423          |0.0          |
|19805_620_2013-01-01_11298_13931|2013-01-01|11298            |13931          |null         |
|19805_621_2013-01-01_11298_14683|2013-01-01|11298            |14683          |0.0          |
|19805_622_2013-01-01_11109_11298|2013-01-01|11109            |11298          |null         |
|19805_623_2013-01-01_11298_14679|2013-01-01|11298            |14679          |0.0          |
|19805_102_2013-01-01_12173_11298|2013-01-01|12173            |11298          |null         |
|19805_116_2013-01-01_12892_11618|2013-01-01|12892            |11618          |null         |
|19805_117_2013-01-01_12478_12892|2013-01-01|12478            |12892          |null         |
|19805_118_2013-01-01_12892_12478|2013-01-01|12892            |12478          |null         |
|19805_119_2013-01-01_11618_12892|2013-01-01|11618            |12892          |0.0          |
|19805_123_2013-01-01_11298_12173|2013-01-01|11298            |12173          |null         |
|19805_129_2013-01-01_13303_12892|2013-01-01|13303            |12892          |null         |
|19805_133_2013-01-01_12478_12892|2013-01-01|12478            |12892          |null         |
|19805_143_2013-01-01_10721_12892|2013-01-01|10721            |12892          |null         |
+--------------------------------+----------+-----------------+---------------+-------------+
only showing top 20 rows

2020-11-07 23:01:54,035 INFO $: Removing cancelled and diverted flights (they are out of this analysis)...
2020-11-07 23:01:54,768 INFO $: flights dataset without cancelled and diverted flights: 500827
2020-11-07 23:01:54,768 INFO $: Removing non-weather related delayed records...
2020-11-07 23:01:55,763 INFO $: flights dataset without non-weather related delay records: 447541
2020-11-07 23:01:55,763 INFO $: computing FL_ONTIME flag (1=on-time; 0=delayed)
+--------------------------------+----------+-----------------+---------------+---------+
|FL_ID                           |FL_DATE   |ORIGIN_AIRPORT_ID|DEST_AIRPORT_ID|FL_ONTIME|
+--------------------------------+----------+-----------------+---------------+---------+
|19805_569_2013-01-01_14635_11298|2013-01-01|14635            |11298          |1.0      |
|19805_570_2013-01-01_11298_11042|2013-01-01|11298            |11042          |1.0      |
|19805_615_2013-01-01_13930_14908|2013-01-01|13930            |14908          |1.0      |
|19805_616_2013-01-01_11298_11433|2013-01-01|11298            |11433          |1.0      |
|19805_617_2013-01-01_11697_11298|2013-01-01|11697            |11298          |1.0      |
|19805_618_2013-01-01_14771_13930|2013-01-01|14771            |13930          |1.0      |
|19805_620_2013-01-01_11298_13931|2013-01-01|11298            |13931          |1.0      |
|19805_622_2013-01-01_11109_11298|2013-01-01|11109            |11298          |1.0      |
|19805_102_2013-01-01_12173_11298|2013-01-01|12173            |11298          |1.0      |
|19805_116_2013-01-01_12892_11618|2013-01-01|12892            |11618          |1.0      |
|19805_117_2013-01-01_12478_12892|2013-01-01|12478            |12892          |1.0      |
|19805_118_2013-01-01_12892_12478|2013-01-01|12892            |12478          |1.0      |
|19805_119_2013-01-01_11618_12892|2013-01-01|11618            |12892          |0.0      |
|19805_123_2013-01-01_11298_12173|2013-01-01|11298            |12173          |1.0      |
|19805_129_2013-01-01_13303_12892|2013-01-01|13303            |12892          |1.0      |
|19805_133_2013-01-01_12478_12892|2013-01-01|12478            |12892          |1.0      |
|19805_143_2013-01-01_10721_12892|2013-01-01|10721            |12892          |1.0      |
|19805_144_2013-01-01_12892_12264|2013-01-01|12892            |12264          |1.0      |
|19805_145_2013-01-01_12478_14679|2013-01-01|12478            |14679          |1.0      |
|19805_149_2013-01-01_12264_12892|2013-01-01|12264            |12892          |1.0      |
+--------------------------------+----------+-----------------+---------------+---------+
only showing top 20 rows

2020-11-07 23:01:56,016 INFO $: mapping flights with the weather stations...
2020-11-07 23:01:57,008 INFO $: flights data after the mapping: 435410
2020-11-07 23:01:57,008 INFO $: computing FL_DATE, FL_DEP_TIME and FL_ARR_TIME
2020-11-07 23:01:57,035 INFO $: balancing the dataset...
2020-11-07 23:01:57,035 INFO $: repartitioning the dataset...
2020-11-07 23:01:57,043 INFO $: counting delayed and on-time flights...
2020-11-07 23:01:59,627 INFO $: number of on-time flights=405083, number of delayed flights=30327
2020-11-07 23:02:01,837 INFO $: number of flights used for the analysis: 60489
+---------------------------------+-----------+-----------+-----------------+---------------+---------+
|FL_ID                            |FL_DEP_TIME|FL_ARR_TIME|ORIGIN_AIRPORT_ID|DEST_AIRPORT_ID|FL_ONTIME|
+---------------------------------+-----------+-----------+-----------------+---------------+---------+
|19805_616_2013-01-01_11298_11433 |1357056600 |1357066200 |11298            |11433          |1.0      |
|19805_618_2013-01-01_14771_13930 |1357089300 |1357103700 |14771            |13930          |1.0      |
|19805_160_2013-01-01_14679_12478 |1357050900 |1357070100 |14679            |12478          |1.0      |
|19805_501_2013-01-01_11298_11638 |1357089300 |1357102200 |11298            |11638          |1.0      |
|19805_505_2013-01-01_13303_15024 |1357048800 |1357058400 |13303            |15024          |1.0      |
|19805_511_2013-01-01_11298_11109 |1357059300 |1357066500 |11298            |11109          |1.0      |
|19805_516_2013-01-01_14843_13303 |1357050000 |1357060200 |14843            |13303          |1.0      |
|19805_14_2013-01-01_13830_12892  |1357112400 |1357130700 |13830            |12892          |1.0      |
|19805_353_2013-01-01_12953_13930 |1357078800 |1357088700 |12953            |13930          |1.0      |
|19805_287_2013-01-01_13303_12892 |1357070100 |1357091100 |13303            |12892          |1.0      |
|19805_288_2013-01-01_13930_10721 |1357085400 |1357093500 |13930            |10721          |1.0      |
|19805_861_2013-01-01_11057_11298 |1357040400 |1357051200 |11057            |11298          |1.0      |
|19805_873_2013-01-01_11433_13303 |1357035600 |1357047000 |11433            |13303          |1.0      |
|19805_1520_2013-01-01_12892_13303|1357063200 |1357080600 |12892            |13303          |1.0      |
|19805_1522_2013-01-01_14771_13930|1357109700 |1357124400 |14771            |13930          |1.0      |
|19805_1724_2013-01-01_10423_11298|1357036800 |1357040400 |10423            |11298          |1.0      |
|19805_1725_2013-01-01_13930_13198|1357096200 |1357101300 |13930            |13198          |1.0      |
|19805_1741_2013-01-01_13930_11697|1357068900 |1357080000 |13930            |11697          |1.0      |
|20363_3283_2013-01-01_11423_11433|1357053900 |1357060320 |11423            |11433          |1.0      |
|20363_3296_2013-01-01_13851_11433|1357072200 |1357080900 |13851            |11433          |1.0      |
+---------------------------------+-----------+-----------+-----------------+---------------+---------+
only showing top 20 rows

2020-11-07 23:02:05,773 INFO $: [flightDataLoad elapsed: 12 s]
2020-11-07 23:02:05,957 INFO $: partitions weatherData: 5
2020-11-07 23:02:06,123 INFO $: partitions flightData: 14
2020-11-07 23:02:06,123 INFO $: joining flights data with weather data
2020-11-07 23:02:06,123 INFO $: repartitioning dep...
2020-11-07 23:02:06,126 INFO $: joining dep...
2020-11-07 23:02:14,749 INFO $: partitions dep:14
2020-11-07 23:02:14,749 INFO $: repartitioning arr...
2020-11-07 23:02:17,377 INFO $: partitions arr:7
2020-11-07 23:02:18,424 INFO $: partitions :7
2020-11-07 23:02:18,424 INFO $: grouping weather records for each flight...
2020-11-07 23:02:19,096 INFO $: partitions :7
2020-11-07 23:02:19,096 INFO $: filling missing weather records for each flight ...
2020-11-07 23:02:52,023 INFO $: data after filling: 46744
2020-11-07 23:02:52,023 INFO $: balancing the dataset...
2020-11-07 23:02:52,023 INFO $: repartitioning the dataset...
2020-11-07 23:02:52,029 INFO $: counting delayed and on-time flights...
2020-11-07 23:03:53,751 INFO $: number of on-time flights=23580, number of delayed flights=23164
+---------+--------------------+
|FL_ONTIME|        WEATHER_COND|
+---------+--------------------+
|      1.0|[0.0,0.0,0.0,1.0,...|
|      1.0|[1.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,0.0,1.0,...|
|      1.0|[0.0,0.0,1.0,0.0,...|
|      1.0|[0.0,0.0,0.0,1.0,...|
|      1.0|[0.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,0.0,1.0,...|
|      1.0|[0.0,0.0,1.0,0.0,...|
|      1.0|[0.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,1.0,0.0,...|
|      1.0|[0.0,0.0,0.0,1.0,...|
|      1.0|[0.0,0.0,1.0,0.0,...|
|      1.0|[1.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,1.0,0.0,...|
|      1.0|[0.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,0.0,1.0,...|
|      1.0|[0.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,0.0,0.0,...|
|      1.0|[0.0,0.0,1.0,0.0,...|
+---------+--------------------+
only showing top 20 rows

2020-11-07 23:05:06,605 INFO $: [data combining elapsed: 180 s]
2020-11-07 23:05:06,605 INFO $: [data preparation elapsed: 249 s]
2020-11-07 23:05:06,702 INFO $: [TRAINING MACHINE LEARNING]
2020-11-07 23:05:06,703 INFO $: Training the model DecisionTree on training data...
2020-11-07 23:05:06,703 INFO $: Training DecisionTree model on the training data
2020-11-07 23:06:25,496 INFO $: Evaluating the model DecisionTree on training data...
2020-11-07 23:06:25,496 INFO $: evaluating the model DecisionTree on the test data...
2020-11-07 23:06:25,523 INFO $: Performance of the model DecisionTree on training data...
2020-11-07 23:06:25,890 INFO $: DecisionTree metrics
        Accuracy         : 68%
        Delayed Recall   : 69%
        Delayed Precision: 64%
        OnTime Recall    : 66%
        OnTime Precision : 71%
2020-11-07 23:06:25,890 INFO $: Evaluating the model DecisionTree on test data...
2020-11-07 23:06:25,891 INFO $: evaluating the model DecisionTree on the test data...
2020-11-07 23:06:25,930 INFO $: Performance of the model DecisionTree on test data...
2020-11-07 23:06:26,551 INFO $: DecisionTree metrics
        Accuracy         : 66%
        Delayed Recall   : 67%
        Delayed Precision: 62%
        OnTime Recall    : 65%
        OnTime Precision : 70%
2020-11-07 23:06:26,551 INFO $: Training the model RandomForest on training data...
2020-11-07 23:06:26,551 INFO $: Training RandomForest model on the training data
2020-11-07 23:06:32,503 INFO $: Evaluating the model RandomForest on training data...
2020-11-07 23:06:32,503 INFO $: evaluating the model RandomForest on the test data...
2020-11-07 23:06:32,526 INFO $: Performance of the model RandomForest on training data...
2020-11-07 23:06:32,863 INFO $: RandomForest metrics
        Accuracy         : 69%
        Delayed Recall   : 72%
        Delayed Precision: 64%
        OnTime Recall    : 67%
        OnTime Precision : 74%
2020-11-07 23:06:32,863 INFO $: Evaluating the model RandomForest on test data...
2020-11-07 23:06:32,863 INFO $: evaluating the model RandomForest on the test data...
2020-11-07 23:06:32,880 INFO $: Performance of the model RandomForest on test data...
2020-11-07 23:06:33,035 INFO $: RandomForest metrics
        Accuracy         : 68%
        Delayed Recall   : 69%
        Delayed Precision: 63%
        OnTime Recall    : 66%
        OnTime Precision : 73%
2020-11-07 23:06:33,124 INFO $: [END: 336 s]
